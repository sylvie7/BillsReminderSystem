@model BillReminderSystem.Models.DashboardViewModel?

@{
    ViewData["Title"] = "Bill Reminder – Dashboard";
}

@if (!User.Identity.IsAuthenticated || Model == null)
{
    <!-- VISITOR / NOT LOGGED IN -->
    <div class="row mt-4">
        <div class="col-lg-10 offset-lg-1">
            <div class="hero shadow-lg">
                <div class="row align-items-center">
                    <div class="col-md-7">
                        <h1 class="mb-3">Never miss a bill again.</h1>
                        <p class="mb-3">
                            A smart personal assistant for your payments – track every bill, see where your
                            money goes, and get reminders before it’s too late.
                        </p>
                        <div class="d-flex flex-wrap gap-2 mt-2">
                            <a asp-area="Identity" asp-page="/Account/Register" class="btn btn-light btn-lg fw-semibold">
                                Get Started
                            </a>
                            <a asp-area="Identity" asp-page="/Account/Login" class="btn btn-outline-light btn-lg">
                                I already have an account
                            </a>
                        </div>
                        <div class="mt-4 small text-white-50">
                            • Secure login &nbsp;• Smart reminders &nbsp;• Insightful spending reports
                        </div>
                    </div>
                    <div class="col-md-5 mt-4 mt-md-0">
                        <div class="glass-card p-3">
                            <h5 class="mb-3">Live preview</h5>
                            <ul class="list-unstyled mb-0">
                                <li class="d-flex justify-content-between mb-2">
                                    <span>Rent – January</span>
                                    <span class="badge bg-danger-subtle text-danger">Overdue</span>
                                </li>
                                <li class="d-flex justify-content-between mb-2">
                                    <span>Electricity</span>
                                    <span class="badge bg-warning text-dark">Due in 2 days</span>
                                </li>
                                <li class="d-flex justify-content-between">
                                    <span>Netflix</span>
                                    <span class="badge bg-success">Paid</span>
                                </li>
                            </ul>
                            <div class="mt-3 small text-white-50">
                                This is how your bills will look once you sign up.
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Feature cards -->
            <div class="row mt-4 g-3">
                <div class="col-md-4">
                    <div class="feature-card shadow-sm h-100">
                        <h5>Smart reminders</h5>
                        <p>
                            See which bills are overdue or due soon at a glance, plus optional email reminders.
                        </p>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="feature-card shadow-sm h-100">
                        <h5>Spending reports</h5>
                        <p>
                            Track how much you spend in each category and over any time period.
                        </p>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="feature-card shadow-sm h-100">
                        <h5>Clean & secure</h5>
                        <p>
                            Built with modern ASP.NET, SQL Server and authentication – ready to grow with you.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
}
else
{
    <!-- LOGGED-IN DASHBOARD -->
    <div class="row mt-4">
        <div class="col-lg-10 offset-lg-1">
            <div class="hero shadow-lg mb-4">
                <div class="row align-items-center">
                    <div class="col-md-8">
                        <h1 class="mb-2">Welcome back, @User.Identity!.Name!</h1>
                        <p class="mb-3">
                            Here’s a quick overview of your bills. Choose what you want to do:
                        </p>
                        <div class="row g-3">
                            <div class="col-md-4">
                                <a asp-controller="Bills" asp-action="Index" class="action-card text-decoration-none">
                                    <div class="action-icon">📋</div>
                                    <h6>View all bills</h6>
                                    <p class="mb-0 small text-muted">Review, update and manage your existing bills.</p>
                                </a>
                            </div>
                            <div class="col-md-4">
                                <a asp-controller="Bills" asp-action="Create" class="action-card text-decoration-none">
                                    <div class="action-icon">➕</div>
                                    <h6>Add new bill</h6>
                                    <p class="mb-0 small text-muted">Create a new reminder in a few seconds.</p>
                                </a>
                            </div>
                            <div class="col-md-4">
                                <a asp-controller="Reports" asp-action="Index" class="action-card text-decoration-none">
                                    <div class="action-icon">📊</div>
                                    <h6>View reports</h6>
                                    <p class="mb-0 small text-muted">See totals and category breakdowns.</p>
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 mt-4 mt-md-0">
                        <div class="glass-card p-3">
                            <h6 class="text-white-50">This month at a glance</h6>
                            <div class="d-flex justify-content-between mt-2">
                                <span>Total bills</span>
                                <span class="fw-semibold">@Model.TotalBills</span>
                            </div>
                            <div class="d-flex justify-content-between mt-1 text-danger">
                                <span>Overdue</span>
                                <span class="fw-semibold">@Model.OverdueBills</span>
                            </div>
                            <div class="d-flex justify-content-between mt-1 text-warning">
                                <span>Due soon (3 days)</span>
                                <span class="fw-semibold">@Model.DueSoonBills</span>
                            </div>
                            <div class="d-flex justify-content-between mt-1 text-success">
                                <span>Paid</span>
                                <span class="fw-semibold">@Model.PaidBills</span>
                            </div>
                            <div class="mt-3 small text-white-50">
                                Use the report section for detailed analytics.
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Upcoming bills + tips -->
            <div class="row g-3">
                <div class="col-lg-8">
                    <div class="card shadow-sm">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <h5 class="mb-0">Upcoming bills</h5>
                            <a asp-controller="Bills" asp-action="Create" class="btn btn-sm btn-primary rounded-pill">
                                + Add bill
                            </a>
                        </div>
                        <div class="card-body">
                            @if (Model.UpcomingBills == null || !Model.UpcomingBills.Any())
                            {
                                <p class="text-muted mb-0">
                                    You have no upcoming unpaid bills. Enjoy the peace of mind. 🎉
                                </p>
                            }
                            else
                            {
                                <table class="table mb-0 align-middle">
                                    <thead>
                                        <tr>
                                            <th>Title</th>
                                            <th>Amount</th>
                                            <th>Due date</th>
                                            <th>Status</th>
                                            <th style="width: 100px;"></th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @foreach (var bill in Model.UpcomingBills)
                                        {
                                            <tr>
                                                <td>@bill.Title</td>
                                                <td>@bill.Amount.ToString("0.00")</td>
                                                <td>@bill.DueDate.ToShortDateString()</td>
                                                <td>
                                                    <span class="badge @(bill.Status == BillReminderSystem.Models.BillStatus.Paid ? "bg-success" : "bg-secondary")">
                                                        @bill.Status
                                                    </span>
                                                </td>
                                                <td>
                                                    <a asp-controller="Bills" asp-action="Edit" asp-route-id="@bill.Id"
                                                       class="btn btn-sm btn-outline-primary rounded-pill">
                                                        Edit
                                                    </a>
                                                </td>
                                            </tr>
                                        }
                                    </tbody>
                                </table>
                            }
                        </div>
                    </div>
                </div>

                <div class="col-lg-4">
                    <div class="card shadow-sm mb-3">
                        <div class="card-body">
                            <h5 class="mb-2">Pro tips</h5>
                            <ul class="list-unstyled mb-0 small text-muted">
                                <li class="mb-1">➤ Use clear titles like “Rent – March” for easier filtering.</li>
                                <li class="mb-1">➤ Mark bills as <strong>Paid</strong> right after payment.</li>
                                <li class="mb-1">➤ Use the <strong>Reports</strong> tab to see where your money goes.</li>
                            </ul>
                        </div>
                    </div>

                    <div class="card shadow-sm">
                        <div class="card-body">
                            <h6 class="mb-2">Need a quick action?</h6>
                            <a asp-controller="Bills" asp-action="Index" class="btn btn-outline-primary btn-sm rounded-pill mb-1 w-100">
                                Manage all bills
                            </a>
                            <a asp-controller="Reports" asp-action="Index" class="btn btn-outline-secondary btn-sm rounded-pill mb-1 w-100">
                                Open reports
                            </a>
                            <a asp-controller="Bills" asp-action="Create" class="btn btn-primary btn-sm rounded-pill w-100">
                                Add new bill
                            </a>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
}