@model IEnumerable<BillReminderSystem.Models.Bill>
@using BillReminderSystem.Models

@{
    ViewData["Title"] = "My Bills";
}

<div class="d-flex justify-content-between align-items-center mt-3 mb-2">
    <div>
        <h2>My Bills</h2>
        <p class="text-muted mb-0">Track upcoming and overdue payments.</p>
    </div>
    <a asp-action="Create" class="btn btn-primary">+ Add New Bill</a>
</div>

@if (!Model.Any())
{
    <div class="alert alert-info mt-3">
        You don’t have any bills yet. Click <strong>“Add New Bill”</strong> to create your first reminder.
    </div>
}
else
{
    <table class="table table-hover mt-3">
        <thead class="table-light">
            <tr>
                <th>Title</th>
                <th>Amount</th>
                <th>Category</th>
                <th>Due Date</th>
                <th>Status</th>
                <th>Reminder</th>
                <th style="width: 150px;"></th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model)
            {
                string rowClass = "";
                string reminderBadgeClass = "badge bg-secondary";
                string reminderText = "-";

                switch (item.ReminderState)
                {
                    case BillReminderState.Overdue:
                        rowClass = "table-danger";
                        reminderBadgeClass = "badge bg-danger";
                        reminderText = "Overdue";
                        break;
                    case BillReminderState.DueSoon:
                        rowClass = "table-warning";
                        reminderBadgeClass = "badge bg-warning text-dark";
                        reminderText = "Due soon";
                        break;
                    default:
                        reminderText = "OK";
                        reminderBadgeClass = "badge bg-success";
                        break;
                }

                <tr class="@rowClass">
                    <td>@item.Title</td>
                    <td>@item.Amount.ToString("0.00")</td>
                    <td>@item.Category</td>
                    <td>@item.DueDate.ToShortDateString()</td>
                    <td>
                        <span class="badge @(item.Status == BillStatus.Paid ? "bg-success" : "bg-secondary")">
                            @item.Status
                        </span>
                    </td>
                    <td>
                        <span class="@reminderBadgeClass">@reminderText</span>
                    </td>
                    <td>
                        <a asp-action="Edit" asp-route-id="@item.Id" class="btn btn-sm btn-outline-primary">Edit</a>
                        <a asp-action="Delete" asp-route-id="@item.Id" class="btn btn-sm btn-outline-danger ms-1">Delete</a>
                    </td>
                </tr>
            }
        </tbody>
    </table>
}